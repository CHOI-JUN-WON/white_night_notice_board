<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
     <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

    <!-- <title>베타 출시 - 개발자 게시판</title> -->
    <title>베타 종료</title>
</head>
<body>
    <div class="main-image">
        <!-- 기본 이미지 div -->
         <p style="width: 100%;height: 100%;text-align: center;display: flex;align-items: center;justify-content: center;font-size: 300%;">베타테스트가 종료되었습니다.<br><br> 더나은서비스로 찾아오겠습니다!</p>
         
        <div id="login_div" style="display: none;">
             <!-- 로그인 페이지 -->
            <div id="login_dialog">
                <p style="font-size: 150%;">개발자 게시판으로 로그인</p>
                <p style="font-size: 110%;">관리자에게 발급받은 ID,PASSWORD을 입력해주세요</p>
                <p class="ID_PASSWORD_text" >ID</p>
                <input type="text" id="id_inp">
                <p class="ID_PASSWORD_text">PASSWORD</p>
                <input type="password" id="password_inp">
                
                <button id="login_btn" onclick="login()">로그인</button> 

            </div>
        </div>
        <div id="main_div">
            <!-- 메인페이지 -->
             
                <div class="side_bar">
                    <p style="font-size: 160%;margin-top: 20%;">백야 게시판 베타</p>
                    <p class="subject_link" onclick="refreshHistory()">전체보기</p>
                    <p class="subject_link">공지</p>
                    <p class="subject_link">개발자 게시판</p>
                    <p class="subject_link">원화 게시판</p>
                    <p class="subject_link">기획게시판</p>
                    <p class="subject_link" onclick="signOut()">로그아웃</p>
                    <div class="uses_div">
                        <p id="uses_text">0글자</p>
                        <p style="border-top: dotted 5px;font-size: 150%;">200000글자</p>
                    </div>
                </div>
                <div id="main_bar">
                    <div id="explor_div" style="display: none;">
                        <!-- <p id="name_subject">OO게시판</p> -->
                        <div class="first_row">
                            <p style="font-size: 150%;margin-right: 315px;margin-left: 70px;">제목</p>
                            <p style="font-size: 150%;margin-right: 70px;">작성자</p>
                            <p style="font-size: 150%;margin-right: 50px;">작성시간</p>
                        </div>
                        <div id="list"></div>
                        

                    </div>
                    <div id="notfound" style="display: none;">
                        <img class="notfound_img"src="https://github.com/CHOI-JUN-WON/white_night_notice_board/blob/main/internet_404_page_not_found.png?raw=true" alt="이미지를 찾을수없음"> 
                        <p>요청한 파일을 찾을수없습니다.</p>     
                        <button onclick="history.back();">뒤로가기</button>                 
                    </div>
                    <div id="read_bar" style="display: none;">
                        <!-- <p id="story_subject_name">OO게시판</p> -->
                        <p id="story_subject_title">백야 개발자 게시판에 오신것을 환영합니다!</p>
                        <p id="story_subject_writer"style="border-bottom: solid 1px;">최준원</p>
                        <div id="body" style="overflow: scroll;">
                            <p id="story_subject_body"></p>
                        </div>
                        

                    </div>
                    
                    <div id="write_story">
                        <p class="write_text">작성</p>
                        <div id="body_input" contenteditable="true" style="border: solid 1px; width: 80%; height: 50%; margin-top: 10px;font-size: 220%;" data-placeholder="여기에 제목을 입력하세요"></div>
                        <div id="body_input" contenteditable="true" style="border: solid 1px; width: 80%; height: 300px; margin-top: 10px;font-size: 200%;"data-placeholder="여기에 제목을 입력하세요"></div>
                        <div id="bar">
                        <label for="category" style="font-size: 120%;">게시판 선택:</label>
                        <select id="category" name="category" style="font-family: 'OngleipStudyWell'; font-size:120%; border-radius: 5px;background-color: #ffffff00;">
                            <option value="">-- 게시판을 선택하세요 --</option>
                            <option value="notice">공지</option>
                            <option value="developer">개발자 게시판</option>
                            <option value="drawing">원화 게시판</option>
                            <option value="plan">기획 게시판</option>
                        </select>

                        <button id="write_btn" style="margin-top: 10px;">작성완료</button>
                        </div>
                        
                    </div>
                    

                </div>
                
        </div>
    </div>
</body>
<script>
    let main_div=document.getElementById('main_div');
    let login_div=document.getElementById('login_div');
    let explor_div=document.getElementById('explor_div');
    let now_subject;
    let now_story;
    let notfound=document.getElementById('notfound');
    let read_bar=document.getElementById('read_bar');
    let write_story=document.getElementById('write_story');

    //점검
    main_div.style.display='none';
    login_div.style.display='none';
    
    /*
    const supabaseUrl = 'https://lkqijqpszrbkhinrfput.supabase.co';//있다고 가정
    const supabaseKey ='eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxrcWlqcXBzenJia2hpbnJmcHV0Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIwMDgzNjYsImV4cCI6MjA3NzU4NDM2Nn0.fpyA7qRmanz0nN_zjWgDovAlGcN4K2EFsvd6kud4ffU';
    const client = supabase.createClient(supabaseUrl, supabaseKey);
    async function login() {
        let input1=document.getElementById("id_inp");
        let input2=document.getElementById("password_inp");
        const email = input1.value;
        const password = input2.value;
        console.log("id"+email);
        console.log("password"+password);
        const { data, error } = await client.auth.signInWithPassword({ email, password });

        if (error) {
            if( error.message=="Invalid login credentials"){
                alert("ID 또는 비밀번호를 확인해주세요");
            }else if(error.message=='User is banned'){
                alert("사용자가 임시 차단되었습니다.");
            }
            console.log(error.message);
        } else {
        alert("로그인 성공!");
        refreshHistory()
        input1.value="";
        input2.value="";
        }
    }
    async function checkLogin() {
       const authInfo = await client.auth.getSession();
       const session = authInfo.data.session;
       
       if (session === null) {
        main_div.style.display='none';
        login_div.style.display='flex'
       } else {
         
        refreshHistory()
       }
     }
     checkLogin();
     async function signOut() {
       const { error } = await client.auth.signOut();
       checkLogin();
     }
     async function refreshHistory() {
       let { data: record, error } = await client.from("notice_board_db").select("*");
       let tag = "";
       for (let i = 0; i < record.length; i++) {
        if(record[i].important==true){
            tag=`<div id="writen_div"><div class="import"><p style="color: #ff4e59;font-size: 150%;">공지<p></div><p style="color: #ff4e59;width:37%;font-size: 150%;margin-right: 50px;"onclick="read_data(${record[i].id});">${record[i].title}</p><p style="font-size: 150%;margin-right: 50px;">${record[i].user_edit_name}</p><p style="font-size: 150%;margin-right: 10px;">${record[i].modifed_at}</p></div>`+tag;
        }
         else{tag+=`<div id="writen_div"><p style="font-size: 150%;margin-right: 50px;width:45%;"onclick="read_data(${record[i].id});">${record[i].title}</p><p style="font-size: 150%;margin-right: 50px;" >${record[i].user_edit_name}</p><p style="font-size: 150%;margin-right: 10px;">${record[i].modifed_at}</p></div>`;}
       }
       document.getElementById('list').innerHTML = tag;
       main_div.style.display='flex';
        login_div.style.display='none';
        main_div.style.display='flex';
        login_div.style.display='none';
        notfound.style.display='none';
        read_bar.style.display='none';
        explor_div.style.display='flex';
        write_story.style.display='none';
     }
     async function read_data(data) {
        let story_subject_title=document.getElementById('story_subject_title');
        let story_subject_writer=document.getElementById('story_subject_writer');
        let story_subject_body=document.getElementById('story_subject_body');
         let { data: record, error } = await client.from("notice_board_db").select("*").eq('id', data);
         if(error){
            console.log(error);
         }else{
            console.log(record);
           story_subject_body.innerText = record[0].body;
            story_subject_writer.innerText = record[0].user_edit_name;
            story_subject_title.innerText = record[0].title;

            main_div.style.display='flex';
            login_div.style.display='none';
            notfound.style.display='none';
            read_bar.style.display='';
            explor_div.style.display='none';
            write_story.style.display='none';
         }
     }
     */


</script>
<style>
    #list{
        width: 70%;
        
    }
    @font-face {
        font-family: 'OngleipStudyWell';
        src: url('https://cdn.jsdelivr.net/gh/projectnoonnu/2411-3@1.0/Ownglyph_StudyHard-Rg.woff2') format('woff2');
        font-weight: normal;
        font-display: swap;
    }
    
    body,head{
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        font-family: 'OngleipStudyWell';
    }
     p{
        margin: 0;
        text-align: center;
        padding: 0;
    }
    
    .main-image{
        background-image: url('https://github.com/CHOI-JUN-WON/notes/blob/main/20250927_140337.jpg?raw=true');
        background-size: cover;
        height: 100vh;
        width: 100vw;
        margin: 0;
    }
    #login_div{
        display: flex;
        align-items: center;
        justify-content: center;
        width: 100vw;
        height: 100vh;
        
    }
    #login_dialog{
        /* box-shadow: seashell 10px; */
        width: 30%;
        height: 45%;
        backdrop-filter: blur(3px);
        
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        border-radius: 20px;
    }
    input{
        border-radius: 7px;
        border: none;
        width: 70%;
        font-size: 150%;
        text-align: center;
        font-family: 'OngleipStudyWell';
    }
    #login_btn{
        font-family: 'OngleipStudyWell';
        margin-top: 10px;
        width: 70%;
        font-size: 150%;
        border-radius: 7px;
        border: none;
       background-color: #ADD1FF;
    }
    #write_btn{
        font-family: 'OngleipStudyWell';
        margin-top: 10px;
        width: 10%;
        font-size: 150%;
        border-radius: 7px;
        border: none;
       background-color: #ADD1FF;
    }
    .ID_PASSWORD_text{
       font-size: 150%; 
        
    }
    #main_div{
        display: flex;
        width: 100vw;
        height: 100vh
    }
    .side_bar{
        height: 100%;
        width: 20%;
    }
    .subject_link{
        font-size: 150%;
        margin-top: 20px;
    }
    #uses_text{
        font-size: 150%;
        margin-bottom: 1px;
    }
    .uses_div{
        width: 40%;
        height: 10%;
        border-radius: 10px;
        margin: 95% 5% 0 auto;
        border: solid 2px;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
    }
    #main_bar{
        width: 80%;
        height: 100%;
    }
    .notfound_img{
        width: 30%;
        height: 40%;
    }
    #notfound{
        width: 100%;
        height: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-items: center;
    }
    .import{
       
        margin-left: 10px;
        margin-right: 10px;
        background-color: #ffe3e4;
        border-radius: 5px;
        width: 5%;
        height: 1%;
        text-align: center;
      }
      #writen_div{
        border-radius: 5px;
         margin-top: 10px;  
         border: solid 1px;
        display: flex;
         width: 100%;
    }
    .first_row{
        border-radius: 5px;
        margin-top: 10px;  
        border: solid 1px;
        display: flex;
        width: 70%;
    }
    #name_subject{
        font-size: 200%;
        margin-top: 10px;
    }
    #explor_div{
        display: flex;
        align-items: center;
        flex-direction: column;
    }
    #body::-webkit-scrollbar {
        width: 0px; /* 스크롤바의 너비 */
    }
    #story_subject_name{
        color: #03c75a;
        font-size: 250%;
        text-align: left;
        margin-left: 50px;
    }
    #story_subject_writer{
        font-size: 120%;
        text-align: left;
        margin-left: 50px;
    }
    #story_subject_title{
        font-size: 220%;
        text-align: left;
        margin-left: 50px;
    }
    #story_subject_body{
        font-size: 200%;
        text-align: left;
        margin-left: 50px;
    }
    .write_text{
        font-size: 200%;
    }
     #write_story{
        display: flex;
        align-items: center;
        flex-direction: column;
    }
    #bar{
        display: flex;
        align-items: center;
        flex-direction: row;
        width: 80%;
    }
    
</style>
</html>
